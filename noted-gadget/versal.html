<!DOCTYPE html>
<html>
<head>
<title>Empty gadget</title>
<script src="bower_components/versal-component-runtime/dist/runtime.min.js"></script>
<script src="bower_components/jquery/dist/jquery.js"></script>
<link rel="import" href="bower_components/versal-gadget-api/versal-gadget-api.html">
</head>

<body>

<canvas id="notesCanvas" width="500" height="100"></canvas>

<!-- <input type="text" id="greeting" readonly value="What is your name?">
<input type="text" id="learnerName"> -->

<div id="notesEditor">
  <span>notes:</span>
  <input type="text" id="notesJson">
</div>

<style>
input {
  font-size: 20px;
  padding: 5px;
  min-width: 300px;
}
/*input#greeting {
  border: 1px solid pink;
}
input#learnerName {
  border: 1px solid green;
}*/
input#notesJson {
  border: 1px solid blue;
}
</style>
</body>

<script>

var drawNotes = function(canvas, notes) {
  console.log(canvas, notes);
}

window.addEventListener('HTMLImportsLoaded', function(){

  var greeting = $('#greeting')[0];
  var learnerName = $('#learnerName')[0];
  var player = new VersalPlayerAPI();
  window.player = player;

  // greeting.addEventListener('change', function (e) {

  //   player.setAttribute(greeting.name, greeting.value);
  // });

  // learnerName.addEventListener('change', function (e) {
  //   player.setLearnerAttribute(learnerName.name, learnerName.value);
  // });

  $('#notesJson').change(function (e) {
    player.setAttribute('notesJson', $('#notesJson').val());
  });

  player.on('attributesChanged', function(data) {
    if (data.notesJson) {
      $('#notesJson').val(data.notesJson);
      drawNotes('le canvas', data.notesJson);
    }
    // if (data.greeting) {
    //   greeting.value = data.greeting;
    // };
  });

  // player.on('learnerStateChanged', function(data) {
  //   if (data.learnerName) {
  //     learnerName.value = data.learnerName;
  //   };
  // });

  player.on('editableChanged', function(editable){
    // greeting.readOnly = !editable.editable;
    // learnerName.readOnly = editable.editable;

    if (editable.editable) {
      $('#notesEditor').show();
    } else {
      $('#notesEditor').hide();
    }
  });

  player.setHeight(200);
  player.startListening();
});
</script>
</html>
